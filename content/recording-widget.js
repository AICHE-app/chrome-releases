(()=>{"use strict";let t=null,n=null,e=0,r=null,o=0,i=0;function s(){if(!n)return;const t=Math.floor((Date.now()-e)/1e3),r=Math.floor(t/60),o=t%60,i=n.querySelector(".timer");i&&(i.textContent=`${String(r).padStart(2,"0")}:${String(o).padStart(2,"0")}`)}function a(){r&&(clearInterval(r),r=null),t&&(t.style.opacity="0",t.style.transform="translateY(20px) scale(0.95)",setTimeout(()=>{t?.remove(),t=null,n=null},300))}window.__aicheWidgetScriptLoaded||(window.__aicheWidgetScriptLoaded=!0,chrome.runtime.onMessage.addListener(d=>{"SHOW_RECORDING_WIDGET"===d.type?function(){t&&t.remove(),t=document.createElement("div"),t.id="aiche-widget-host",t.style.position="fixed",t.style.bottom="24px",t.style.right="24px",t.style.zIndex="2147483647",t.style.pointerEvents="auto",t.style.cursor="move",t.style.margin="0",t.style.padding="0",t.style.border="none",t.style.background="none";const a=function(){try{const t=localStorage.getItem("aiche-widget-pos");if(t){const n=JSON.parse(t);return{x:n.x||0,y:n.y||0}}}catch{}return{x:0,y:0}}();0===a.x&&0===a.y||(t.style.transform=`translate(${a.x}px, ${a.y}px)`,o=a.x,i=a.y),n=t.attachShadow({mode:"closed"}),n.innerHTML='\n\t\t<style>\n\t\t\t* {\n\t\t\t\tmargin: 0;\n\t\t\t\tpadding: 0;\n\t\t\t\tbox-sizing: border-box;\n\t\t\t}\n\n\t\t\t:host {\n\t\t\t\tall: initial;\n\t\t\t\tcolor-scheme: dark;\n\t\t\t\t--widget-bg: linear-gradient(\n\t\t\t\t\t135deg,\n\t\t\t\t\trgba(255, 255, 255, 0.1) 0%,\n\t\t\t\t\trgba(255, 255, 255, 0.05) 50%,\n\t\t\t\t\trgba(0, 0, 0, 0.1) 100%\n\t\t\t\t);\n\t\t\t\t--widget-shadow:\n\t\t\t\t\tinset 0 1px 1px rgba(255, 255, 255, 0.15),\n\t\t\t\t\tinset 0 -1px 1px rgba(0, 0, 0, 0.1),\n\t\t\t\t\t0 4px 24px rgba(0, 0, 0, 0.4);\n\t\t\t\t--widget-border: rgba(255, 255, 255, 0.12);\n\t\t\t\t--widget-text: rgba(255, 255, 255, 0.95);\n\t\t\t}\n\n\t\t\t.widget {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tgap: 12px;\n\t\t\t\tbackground: var(--widget-bg);\n\t\t\t\tbackdrop-filter: blur(20px);\n\t\t\t\t-webkit-backdrop-filter: blur(20px);\n\t\t\t\tborder-radius: 40px;\n\t\t\t\tpadding: 8px 18px 8px 8px;\n\t\t\t\tbox-shadow: var(--widget-shadow);\n\t\t\t\tborder: 1px solid var(--widget-border);\n\t\t\t\tfont-family: -apple-system, BlinkMacSystemFont, sans-serif;\n\t\t\t\tcursor: move;\n\t\t\t\tuser-select: none;\n\t\t\t}\n\n\t\t\t.stop-btn {\n\t\t\t\tposition: relative;\n\t\t\t\twidth: 48px;\n\t\t\t\theight: 48px;\n\t\t\t\tbackground: linear-gradient(135deg, #FF7B47, #FF6B35);\n\t\t\t\tborder-radius: 50%;\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: center;\n\t\t\t\tcursor: pointer;\n\t\t\t\tflex-shrink: 0;\n\t\t\t\tborder: none;\n\t\t\t\toverflow: hidden;\n\t\t\t}\n\n\t\t\t.stop-btn:active {\n\t\t\t\ttransform: scale(0.92);\n\t\t\t}\n\n\t\t\t.stop-btn svg {\n\t\t\t\twidth: 24px;\n\t\t\t\theight: 24px;\n\t\t\t}\n\n\t\t\t.timer {\n\t\t\t\tfont-size: 22px;\n\t\t\t\tfont-weight: 400;\n\t\t\t\tcolor: var(--widget-text);\n\t\t\t\tfont-variant-numeric: tabular-nums;\n\t\t\t\tmin-width: 50px;\n\t\t\t\ttext-align: center;\n\t\t\t}\n\n\t\t\t.widget.processing .stop-btn {\n\t\t\t\tbackground: linear-gradient(135deg, #5EC977, #4CAF50);\n\t\t\t}\n\n\t\t\t.widget.processing .stop-btn svg {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\n\t\t\t.widget.processing .stop-btn::after {\n\t\t\t\tcontent: \'\';\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 50%;\n\t\t\t\tleft: 50%;\n\t\t\t\tmargin-top: -6px;\n\t\t\t\tmargin-left: -6px;\n\t\t\t\twidth: 12px;\n\t\t\t\theight: 12px;\n\t\t\t\tbackground: white;\n\t\t\t\tborder-radius: 50%;\n\t\t\t\tanimation: breathe 1.5s ease-in-out infinite;\n\t\t\t}\n\n\t\t\t@keyframes breathe {\n\t\t\t\t0%, 100% { opacity: 0.4; transform: scale(0.8); }\n\t\t\t\t50% { opacity: 1; transform: scale(1.1); }\n\t\t\t}\n\n\t\t\t.widget.completed .stop-btn {\n\t\t\t\tbackground: linear-gradient(135deg, #5EC977, #4CAF50);\n\t\t\t\tpointer-events: none;\n\t\t\t}\n\n\t\t\t.widget.completed .stop-btn svg {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\n\t\t\t.widget.completed .stop-btn::after {\n\t\t\t\tcontent: \'\';\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 50%;\n\t\t\t\tleft: 50%;\n\t\t\t\twidth: 14px;\n\t\t\t\theight: 8px;\n\t\t\t\tmargin-top: -8px;\n\t\t\t\tmargin-left: -9px;\n\t\t\t\tborder-left: 4px solid white;\n\t\t\t\tborder-bottom: 4px solid white;\n\t\t\t\tborder-radius: 2px;\n\t\t\t\ttransform: rotate(-45deg) scale(0);\n\t\t\t\ttransform-origin: center center;\n\t\t\t\tanimation: checkmark 0.4s ease-out 0.1s forwards;\n\t\t\t}\n\n\t\t\t@keyframes checkmark {\n\t\t\t\t0% { transform: rotate(-45deg) scale(0); opacity: 0; }\n\t\t\t\t50% { transform: rotate(-45deg) scale(1.2); opacity: 1; }\n\t\t\t\t100% { transform: rotate(-45deg) scale(1); opacity: 1; }\n\t\t\t}\n\n\t\t\t\t\t</style>\n\t\t<div class="widget">\n\t\t\t<div class="stop-btn">\n\t\t\t\t<svg viewBox="0 0 24 24" fill="white">\n\t\t\t\t\t<rect x="6" y="6" width="12" height="12" rx="1"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t\t<div class="timer">00:00</div>\n\t\t</div>\n\t',document.body.appendChild(t),function(){if(!t)return;let e=!1,r=o,s=i,a=0,d=0;if(t.addEventListener("mousedown",n=>{e=!0,a=n.clientX-r,d=n.clientY-s,t.style.cursor="grabbing"}),document.addEventListener("mousemove",n=>{e&&t&&(r=n.clientX-a,s=n.clientY-d,t.style.transform=`translate(${r}px, ${s}px)`)}),document.addEventListener("mouseup",()=>{e&&function(t,n){o=t,i=n;try{localStorage.setItem("aiche-widget-pos",JSON.stringify({x:t,y:n}))}catch{}}(r,s),e&&t&&(e=!1,t.style.cursor="move")}),n){const o=n.querySelector(".widget");o&&o.addEventListener("mousedown",n=>{e=!0;const o=n;a=o.clientX-r,d=o.clientY-s,t.style.cursor="grabbing"})}}(),function(){if(!n)return;const t=n.querySelector(".stop-btn");t&&t.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),chrome.runtime.sendMessage({type:"STOP_RECORDING"})})}(),e=Date.now(),s(),r=window.setInterval(s,1e3)}():"WIDGET_PROCESSING"===d.type?function(){if(!n)return;r&&(clearInterval(r),r=null);const t=n.querySelector(".widget");t&&t.classList.add("processing");const e=n.querySelector(".timer");e&&(e.textContent="AI")}():"WIDGET_COMPLETED"===d.type?function(t){if(!n)return;const e=n.querySelector(".widget");e&&(e.classList.remove("processing"),e.classList.add("completed"));const r=n.querySelector(".timer");r&&(r.textContent=`${t} words`),setTimeout(()=>a(),1500)}(d.wordCount||0):"HIDE_RECORDING_WIDGET"===d.type&&a()}))})();